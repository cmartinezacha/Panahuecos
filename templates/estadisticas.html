{% extends "layout.html" %}

{% block head %}
      <link rel="stylesheet" href="static/estadisticas.css">
      <script src="static/charts/Chart.min.js"></script>
{% endblock %}



{% block content %}

<div class="container">
	
	<div class="col-md-4 left-part">
		<div class="reportes-review">
			<div class="glyphicon glyphicon-file glyphicon-stats-reportes"></div>
			<h4 class="reportes-titulo-stats">Reportes</h4>
			<h1 class="numero-de-reportes">{{reportes.count()}}</h1>

			<table class="reportes-stats" style="width:100%">
			  <tr>
			    <td class="tipo-stat">Reportes completados</td>
			    <td class="numero-de-r">{{reportes| reportes_filter_state("Completo")}}</td>
			  </tr>
			  <tr>
			    <td class="tipo-stat">Reportes en proceso</td>		
			    <td class="numero-de-r">{{reportes| reportes_filter_state("En proceso")}}</td>
			  </tr>
			  <tr>
			    <td class="tipo-stat">Reportes en inspección</td>		
			    <td class="numero-de-r">{{reportes| reportes_filter_state("En inspección")}}</td>
			  </tr>
			  <tr>
			    <td class="tipo-stat">Reportes iniciados</td>		
			    <td class="numero-de-r">{{reportes| reportes_filter_state("Iniciado")}}</td>
			  </tr>
			  <tr>
			    <td class="tipo-stat">Reportes vencidos</td>		
			    <td class="numero-de-r">{{reportes| reportes_filter_state("Vencido")}}</td>
			  </tr>
			</table>
		</div> <!--reportes review-->

		<div class="reportes-metidos">
			<h4 class="reportes-metidos-titulo">Reportes subidos</h4>
			<div style="width:100%">
				<div>
					<canvas id="canvas2" height="320" width="600"></canvas>
				</div>
			</div>
			<script charset="utf-8">
				var randomScalingFactor = function(){ return Math.round(Math.random()*100)};
				var lineChartData = {
					labels: ['Viernes', 'Sábado', 'Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves'],
					// labels : {{days}},
					datasets : [
						{
							label: "My First dataset",
							fillColor : "rgba(220,220,220,0.2)",
							strokeColor : "rgba(220,220,220,1)",
							pointColor : "rgba(220,220,220,1)",
							pointStrokeColor : "#fff",
							pointHighlightFill : "#fff",
							pointHighlightStroke : "rgba(220,220,220,1)",
							data : {{amounts_by_day}}
						}]
					}
			</script>
		</div>

		<div class="filtros-de-stats">
			<h5 class="filtro-titulo-stats">Ver estadisticas solo de:</h5>
			<div align="center" class="filtros-stats">
				<select name="area">
					{% for region in regiones %}
					<option>{{region}}</option>
					{% endfor %}
			 	</select> 
		        <select name="problema">
		      	  	{% for problema in problemas %}
		      	  	<option>{{problema}}</option>
		      	  	{% endfor %}
	     		</select>
     		</div>
     		<p align="center">
			  <button class="btn btn-primary actualizar-stats" type="button">Actualizar</button>
			</p>

		</div> <!--filtros de stats-->
	</div> <!--col-md-4-->

	<div class="col-md-8">
		<div class="row stats-de-region">
			<p class="titulo-region-stats">Reportes Por Región</p>
			<div style="width: 100%">
				<canvas id="canvas" height="270" width="600"></canvas>
			</div>
			<script charset="utf-8">

				var barChartData = {
					labels : ['Areas Canaleras', 'San Miguelito', 'Pnma. Centro', 'Pnma. Oeste','Pnma. Norte', 'Pnma.Este', 'Bocas del Toro','Chiriquí', 'Veraguas',  'Colón', 'Coclé', 'Herrera', 'Los Santos', 'Darién', 'Comarca Ngobe'],
					datasets : [
						{
							fillColor : "rgba(40,158,205,0.5)",
							strokeColor : "rgba(40,158,205,0.8)",
							highlightFill: "rgba(40,158,205,0.75)",
							highlightStroke: "rgba(40,158,205,1)",
							data : {{amounts_by_region}}
						},

					]

				}

				</script>
		</div>

		<div class="row">
			<div class="col-md-6 stats-de-tiempo">
				<p class="titulo-tiempo-stats">Tiempo para completar reportes</p>
				<div class="wrapper-tiempo-stats">
					<div id="canvas-holder2">
						<canvas id="chart-area2" height="300" width="300" style="width: 200px; height: 200px"/>
					</div>
					<div class="leyenda2 pull-right">
						<p class="leyenda-unica l-12sem"><span class=" glyphicon glyphicon-asterisk"></span> 1-2 semanas</p>
						<p class="leyenda-unica l-34sem"><span class=" glyphicon glyphicon-asterisk"></span> 3-4 semanas</p>
						<p class="leyenda-unica l-12mes"><span class=" glyphicon glyphicon-asterisk"></span> 1-2 meses</p>
						<p class="leyenda-unica l-34mes"><span class=" glyphicon glyphicon-asterisk"></span> 3-4 meses</p>
						<p class="leyenda-unica l-4mes"><span class=" glyphicon glyphicon-asterisk"></span> 4 meses+</p>
					</div>
				</div>

				<script>

					var pieData2 = [
							{
								value: 36,
								color: "#a9d8eb",
								highlight: "#B2DCED",
								label: "Una a dos semanas"
							},
							{
								value: 12,
								color:"#7ec4e1",
								highlight: "#8BCAE4",
								label: "Tres a cuatro semanas"
							},
							{
								value: 7,
								color: "#52b1d7",
								highlight: "#63B9DB",
								label: "Uno a dos meses"
							},
							{
								value: 11,
								color: "#289ecd",
								highlight: "#3EA8D2",
								label: "Tres a cuatro meses"
							},
							{
								value: 9,
								color: "#207ea4",
								highlight: "#368BAD",
								label: "Más de cuatro meses"
							}

						];
				</script>

			</div>

			<div class="col-md-6 stats-de-dano">
				<p class="titulo-tipo-stats">Distribución de daños</p>
				<div class="wrapper-dano-stats">
					<div id="canvas-holder">
						<canvas id="chart-area" height="150" width="150"/>
					</div>
					<div class="leyenda pull-right">
						<p class="leyenda-unica hueco-s"><span class=" glyphicon glyphicon-asterisk"></span> Huecos</p>
						<p class="leyenda-unica alcantarilla-s"><span class=" glyphicon glyphicon-asterisk"></span> Alcantarillas</p>
						<p class="leyenda-unica cajonesp-s"><span class=" glyphicon glyphicon-asterisk"></span> Cajones P.</p>
						<p class="leyenda-unica puente-s"><span class=" glyphicon glyphicon-asterisk"></span> Puentes</p>
						<p class="leyenda-unica otros-s"><span class=" glyphicon glyphicon-asterisk"></span> Otros</p>
					</div>
				</div>

				<script>

					var pieData = [
							{
								value: {{reportes| reportes_filter_problema("Hueco")}},
								color: "#a9d8eb",
								highlight: "#B2DCED",

								label: "Huecos"
							},
							{
								value: {{reportes| reportes_filter_problema("Alcantarilla")}},
								color:"#7ec4e1",
								highlight: "#8BCAE4",

								label: "Alcantarillas"
							},
							{
								value: {{reportes| reportes_filter_problema("Cajones Pluviales")}},
								color: "#52b1d7",
								highlight: "#63B9DB",
								label: "Cajones Pluviales"
							},

							{
								value: {{reportes| reportes_filter_problema("Puente")}},
								color: "#289ecd",
								highlight: "#3EA8D2",
								label: "Puentes"
							},
							{
								value: {{reportes| reportes_filter_problema("Otro")}},
								color: "#207ea4",
								highlight: "#368BAD",
								label: "Otros"
							}

						];

						window.onload = function(){
							var ctx = document.getElementById("canvas").getContext("2d");
							window.myBar = new Chart(ctx).Bar(barChartData, {
								responsive : true,
								animation: true,
								scaleFontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",
								scaleFontSize: 8,
								scaleBeginAtZero: true,
								scaleShowVerticalLines : false,
								scaleShowHorizontalLines: false,
								tooltipFontSize: 14,
								
							});
							var ctx2 = document.getElementById("chart-area").getContext("2d");
							window.myPie = new Chart(ctx2).Pie(pieData, {
								responsive:true,
								showScale:true,
								tooltipFontSize: 18,
							});
							var ctx3 = document.getElementById("chart-area2").getContext("2d");
							window.myPie = new Chart(ctx3).Pie(pieData2, {
								responsive:true,
								showScale:true,
								tooltipFontSize: 18,
							});
							var ctx4 = document.getElementById("canvas2").getContext("2d");
							window.myLine = new Chart(ctx4).Line(lineChartData, {
								responsive: true,
								scaleShowVerticalLines : false,
								scaleShowHorizontalLines: false,
							});
						};



				</script>
			</div>
		</div>
	</div>

</div>



{% endblock %}